webpackJsonp([41],{MKKR:function(e,t){},qyXW:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={data:()=>({userType:sessionStorage.getItem("userType"),page:1,pageSize:10,totalNum:100,form:{item:"",address:"",level:"",supervisionunitid:""},addOrUpTit:"",addForm:{id:null,name:null,level:null,address:null,pid:null},tableData:[],levelList:[],fatherList:[],supervisionunitList:[],multipleSelection:[],centerDialogVisible:!1,innerVisible:!1,endPickerOptions:{disabledDate:e=>e.getTime()<Date.now()-864e5}}),mounted(){this.getData()},methods:{setAdminUser(e){var t;"系统"==sessionStorage.getItem("userType")?t="国家管理单位":"国家管理单位"==sessionStorage.getItem("userType")?t="省管理单位":"省管理单位"==sessionStorage.getItem("userType")?t="市管理单位":"市管理单位"==sessionStorage.getItem("userType")&&(t="区管理单位"),this.$router.replace({path:"/adminUser",query:{belongid:e.id,gsName:e.name,type:t}})},getData(){var e=this;this.$ajax.get("/recovery/supervisionunit/selectVByPage",{params:{page:this.page,rows:this.pageSize,address:this.form.address,name:this.form.item,pid:sessionStorage.getItem("belongId")}}).then(function(t){console.log(t),260==t.data.status?(e.tableData=t.data.list,e.totalNum=t.data.info.total):(e.tableData=[],e.totalNum=0)})},changePage(e){this.page=e,this.getData()},selectList(){this.page=1,this.getData()},add(){this.$refs.upFile.click()},fileChanged(){const e=this.$refs.upFile.files;if(console.log(e),0!=e.length)for(var t=this,s=0;s<e.length;s++){var a=new FormData,i=e[s];a.append("excelFile",i),a.append("pid",sessionStorage.getItem("belongId")),a.append("usertype",sessionStorage.getItem("userType")),this.$ajax.post("/recovery/addSupervisionunit/add",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){console.log(260==e.data.status),t.getData(),t.$refs.upFile.value="",260==e.data.status?t.$message.success("导入监管单位成功"):t.$message.error("导入监管单位失败,请重试！")})}else alert("请选择文件")},clearSelect(){this.form={item:"",address:"",level:"",supervisionunitid:""},this.getData()},clearForm(){this.addForm={id:null,name:null,level:"全国",address:null,pid:sessionStorage.getItem("belongId")},console.log(sessionStorage.getItem("userType")),"系统"==sessionStorage.getItem("userType")?this.addForm.level="全国":"国家管理单位"==sessionStorage.getItem("userType")?this.addForm.level="省":"省管理单位"==sessionStorage.getItem("userType")?this.addForm.level="市":"市管理单位"==sessionStorage.getItem("userType")&&(this.addForm.level="区")},clickAddOrUp(){this.centerDialogVisible=!0,this.addOrUpTit="创建监管单位",this.clearForm()},handleEdit(e,t){console.log(e,t);this.centerDialogVisible=!0,this.addOrUpTit="编辑监管单位",this.addForm={id:t.id,name:t.name,level:t.level,pid:t.pid,address:t.address}},addSaveForm(){console.log(this.addForm);var e=this;if(null!=this.addForm.name&&null!=this.addForm.level&&null!=this.addForm.address){var t=this.$qs.stringify(this.addForm,{indices:!1});"创建监管单位"==this.addOrUpTit?this.$ajax.post("/recovery/supervisionunit//insert ",t).then(function(t){260==t.data.status&&(e.centerDialogVisible=!1,e.$message.success("添加成功"),e.getData(),e.clearForm())}):this.$ajax.put("/recovery/supervisionunit/update",t).then(function(t){260==t.data.status&&(e.centerDialogVisible=!1,e.$message.success("编辑成功"),e.getData(),e.clearForm())})}else this.$message.error("*为必填项！")},delAll(){if(this.multipleSelection.length<1)return this.$message.success("请先选择删除对象");this.$confirm("此操作将永久删除选中的监管单位, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.multipleSelection.length==this.tableData.length&&(this.page=Number(this.page)-1);var e=this;this.$ajax.delete("/recovery/supervisionunit/deletes",{data:this.multipleSelection}).then(function(t){260==t.data.status&&(e.$message.success("删除成功"),e.getData())})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},handleSelectionChange(e){this.multipleSelection=[];for(var t=0;t<e.length;t++)this.multipleSelection.push(e[t].id);console.log(this.multipleSelection)},handleDelete(e,t){this.$confirm("此操作将删除该监管单位, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log(e,t),1==this.tableData.length&&(this.page=Number(this.page)-1);var s=this;this.$ajax.delete("/recovery/supervisionunit/delete",{params:{id:t}}).then(function(e){260==e.data.status&&(s.$message.success("删除成功"),s.getData())})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"yudingBox"}},[s("div",{staticClass:"selectBox"},[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[s("el-form-item",{attrs:{label:"单位名称"}},[s("el-input",{attrs:{placeholder:"请输入单位名称"},on:{change:e.selectList},model:{value:e.form.item,callback:function(t){e.$set(e.form,"item",t)},expression:"form.item"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"地址"}},[s("el-input",{attrs:{placeholder:"请输入单位地址"},on:{change:e.selectList},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),s("el-form-item",[s("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"warning",size:"small"},on:{click:e.clearSelect}},[e._v("清空筛选")]),e._v(" "),s("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"primary",size:"small"},on:{click:e.add}},[e._v("批量导入")]),e._v(" "),s("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"upFile",attrs:{type:"file"},on:{change:e.fileChanged}})],1)],1)],1),e._v(" "),s("div",{staticClass:"tableBox"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"单位名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"level",label:"级别"}}),e._v(" "),"系统"==e.userType||"国家管理单位"==e.userType||"省管理单位"==e.userType||"市管理单位"==e.userType?s("el-table-column",{attrs:{prop:"address",label:"所属行政区域"}}):s("el-table-column",{attrs:{prop:"address",label:"地址"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"270"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){return e.setAdminUser(t.row)}}},[e._v("设置管理员")]),e._v(" "),s("el-button",{attrs:{size:"mini"},on:{click:function(s){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.handleDelete(t.$index,t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("div",{staticClass:"pafinationBox"},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.clickAddOrUp}},[e._v("添加监管单位")]),e._v(" "),s("el-button",{attrs:{type:"warning"},on:{click:e.delAll}},[e._v("批量删除")])],1),e._v(" "),s("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":e.pageSize,total:e.totalNum},on:{"current-change":e.changePage}})],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.addOrUpTit,visible:e.centerDialogVisible,width:"600px",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[s("div",{staticClass:"dialogMain"},[s("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"单位名称",required:""}},[s("el-input",{model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),e._v(" "),"系统"==e.userType||"国家管理单位"==e.userType||"省管理单位"==e.userType||"市管理单位"==e.userType?s("el-form-item",{attrs:{label:"所属行政区域",required:""}},[s("el-input",{model:{value:e.addForm.address,callback:function(t){e.$set(e.addForm,"address",t)},expression:"addForm.address"}})],1):s("el-form-item",{attrs:{label:"地址",required:""}},[s("el-input",{model:{value:e.addForm.address,callback:function(t){e.$set(e.addForm,"address",t)},expression:"addForm.address"}})],1)],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addSaveForm()}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var l=s("VU/8")(a,i,!1,function(e){s("MKKR")},"data-v-2cdc2816",null);t.default=l.exports}});
//# sourceMappingURL=41.16ede30d68f6e297dcdf.js.map