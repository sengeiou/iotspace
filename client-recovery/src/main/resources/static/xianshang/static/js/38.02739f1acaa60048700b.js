webpackJsonp([38],{I1l2:function(t,e){},gptr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l={filters:{formatDate:function(t){var e=new Date(t),a=e.getFullYear(),l=e.getMonth()+1,s=e.getDate(),r=e.getHours(),i=e.getMinutes();return l<10&&(l="0"+l),r<10&&(r="0"+r),i<10&&(i="0"+i),a+"-"+l+"-"+s+" "+r+":"+i}},data:()=>({page:1,pageSize:10,totalNum:100,form:{vehicleid:"",userid:"",starttime:null,endtime:null,status:null,type:null},addOrUpTit:"",addForm:{id:null,number:null,userid:null,note:null,status:null,type:null,vehicleid:null},tableData:[],userList:[],statusList:[],typeList:[],carList:[],hospitalIf:!1,hospitalJoinList:[],chulichangIf:!1,chulichangList:[],shengchangIf:!1,shengchangList:[],yunshuIf:!1,yunshuList:[],multipleSelection:[],centerDialogVisible:!1,innerVisible:!1,endPickerOptions:{disabledDate:t=>t.getTime()<Date.now()-864e5}}),mounted(){this.getData(),this.getSelectList()},methods:{getSelectList(){var t=this,e={id:"",username:"全部"};this.$ajax.get("/recovery/user/transportcompanyUser",{params:{role:"运输员",transportcompany:sessionStorage.getItem("belongId")}}).then(function(a){console.log("司机列表",a),t.userList=a.data.list,t.userList.unshift(e)});var a={value:"",text:"全部"};this.$ajax.get("/recovery/truck/statusList").then(function(e){console.log("type列表",e),t.statusList=e.data.list,t.statusList.unshift(a)}),this.$ajax.get("/recovery/truck/typeList").then(function(e){console.log("type列表",e),t.typeList=e.data.list,t.typeList.unshift(a)});var l={id:"",number:"全部"};this.$ajax.get("/recovery/vehicle/selectByTransportcompanyId",{params:{transportcompanyid:sessionStorage.getItem("belongId")}}).then(function(e){console.log("type列表",e),t.carList=e.data.list,t.carList.unshift(l)})},getData(){var t=this;null==this.form.starttime&&(this.form.starttime=""),null==this.form.endtime&&(this.form.endtime=""),this.$ajax.get("/recovery/truck/selectVByPage",{params:{page:this.page,rows:this.pageSize,transportcompanyid:sessionStorage.getItem("belongId"),vehicleid:this.form.vehicleid,userid:this.form.userid,status:this.form.status,type:this.form.type,begintime:""==this.form.starttime?"":new Date(this.form.starttime)/1e3*1e3,endtime:""==this.form.endtime?"":new Date(this.form.endtime)/1e3*1e3}}).then(function(e){console.log(e),260==e.data.status?(t.tableData=e.data.list,t.totalNum=e.data.info.total):(t.tableData=[],t.totalNum=0)})},changePage(t){this.page=t,this.getData()},lookGarbagebag(t,e){var a=this;this.$ajax.get("/recovery/truck/truckRecord",{params:{truckid:t.id,type:t.type}}).then(function(t){console.log(t),1==e?a.hospitalIf=!0:2==e||6==e||7==e?a.chulichangIf=!0:3==e?a.hospitalIf=!0:4==e||5==e?a.yunshuIf=!0:8==e&&(a.shengchangIf=!0),260==t.data.status&&(1==e?a.hospitalJoinList=t.data.truckhospital:2==e||6==e?a.chulichangList=t.data.trucktreatmentplant:3==e?a.hospitalJoinList=t.data.truckhospital:4==e||5==e?a.yunshuList=t.data.trucktransportcompany:7==e?a.chulichangList=t.data.trucktreatmentplantreceive:8==e&&(a.shengchangList=t.data.truckproductionplant))})},selectList(){this.page=1,this.getData()},clearSelect(){this.form={vehicleid:"",userid:"",starttime:null,endtime:null,status:null,type:null},this.getData()},clearForm(){this.addForm={id:null,number:null,userid:null,note:null,status:"未完成",type:null,vehicleid:null,transportcompanyid:sessionStorage.getItem("belongId")}},clickAddOrUp(){this.centerDialogVisible=!0,this.addOrUpTit="创建车次",this.clearForm()},handleEdit(t,e){console.log(t,e);this.centerDialogVisible=!0,this.addOrUpTit="编辑车次",this.addForm={id:e.id,number:e.vehicle.number,userid:e.userid,note:e.note,time:e.time,status:e.status,type:e.type,transportcompanyid:e.transportcompanyid,vehicleid:e.vehicleid}},addSaveForm(){console.log(this.addForm);var t=this;if(null!=this.addForm.userid&&null!=this.addForm.vehicleid&&null!=this.addForm.type&&null!=this.addForm.status){var e=this.$qs.stringify(this.addForm,{indices:!1});"创建车次"==this.addOrUpTit?this.$ajax.post("/recovery/truck//insert",e).then(function(e){260==e.data.status&&(t.centerDialogVisible=!1,t.$message.success("添加成功"),t.getData(),t.clearForm())}):this.$ajax.put("/recovery/truck/update",e).then(function(e){260==e.data.status&&(t.centerDialogVisible=!1,t.$message.success("编辑成功"),t.getData(),t.clearForm())})}else this.$message.error("*为必填项！")},delAll(){if(this.multipleSelection.length<1)return this.$message.success("请先选择删除对象");this.$confirm("此操作将永久删除选中的车次, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.multipleSelection.length==this.tableData.length&&(this.page=Number(this.page)-1);var t=this;this.$ajax.delete("/recovery/truck/deletes",{data:this.multipleSelection}).then(function(e){260==e.data.status&&(t.$message.success("删除成功"),t.getData())})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},handleSelectionChange(t){this.multipleSelection=[];for(var e=0;e<t.length;e++)this.multipleSelection.push(t[e].id);console.log(this.multipleSelection)},handleDelete(t,e){this.$confirm("此操作将删除该车次, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log(t,e),1==this.tableData.length&&(this.page=Number(this.page)-1);var a=this;this.$ajax.delete("/recovery/truck/delete",{params:{id:e}}).then(function(t){260==t.data.status&&(a.$message.success("删除成功"),a.getData())})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"yudingBox"}},[a("div",{staticClass:"selectBox"},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"60px"}},[a("el-form-item",{attrs:{label:"车辆"}},[a("el-select",{attrs:{placeholder:"请选择车辆"},on:{change:t.selectList},model:{value:t.form.vehicleid,callback:function(e){t.$set(t.form,"vehicleid",e)},expression:"form.vehicleid"}},t._l(t.carList,function(t,e){return a("el-option",{key:e,attrs:{label:t.number,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"运输人"}},[a("el-select",{attrs:{placeholder:"请选择运输人"},on:{change:t.selectList},model:{value:t.form.userid,callback:function(e){t.$set(t.form,"userid",e)},expression:"form.userid"}},t._l(t.userList,function(t,e){return a("el-option",{key:e,attrs:{label:t.username,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{placeholder:"请选择状态"},on:{change:t.selectList},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.statusList,function(t,e){return a("el-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"请选择状态"},on:{change:t.selectList},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.typeList,function(t,e){return a("el-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"时间"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"起始日期","value-format":"yyyy/MM/dd"},on:{change:t.selectList},model:{value:t.form.starttime,callback:function(e){t.$set(t.form,"starttime",e)},expression:"form.starttime"}})],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"结束日期","value-format":"yyyy/MM/dd"},on:{change:t.selectList},model:{value:t.form.endtime,callback:function(e){t.$set(t.form,"endtime",e)},expression:"form.endtime"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"warning",size:"small"},on:{click:t.clearSelect}},[t._v("清空筛选")])],1)],1)],1),t._v(" "),a("div",{staticClass:"tableBox"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"90%"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"time",label:"时间",width:"150",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.time?a("span"):a("span",[t._v(t._s(t._f("formatDate")(e.row.time)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"transportcompany.name",label:"所属公司"}}),t._v(" "),a("el-table-column",{attrs:{prop:"vehicle.number",label:"车牌号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"user.username",label:"运输人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",["医疗机构-回收利用企业"==e.row.type?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.lookGarbagebag(e.row,1)}}},[t._v("医疗机构记录")]):t._e(),t._v(" "),"医疗机构-回收物流"==e.row.type?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.lookGarbagebag(e.row,3)}}},[t._v("医疗机构记录")]):t._e(),t._v(" "),"回收物流-回收利用企业"==e.row.type?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.lookGarbagebag(e.row,5)}}},[t._v("回 收 物 流")]):t._e(),t._v(" "),"回收利用企业-再利用企业"==e.row.type?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.lookGarbagebag(e.row,7)}}},[t._v("回收利用企业交接")]):t._e(),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")])],1),t._v(" "),a("p",{staticStyle:{"margin-top":"5px"}},["医疗机构-回收利用企业"==e.row.type?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.lookGarbagebag(e.row,2)}}},[t._v("回收利用企业记录")]):t._e(),t._v(" "),"医疗机构-回收物流"==e.row.type?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.lookGarbagebag(e.row,4)}}},[t._v("回 收 物 流")]):t._e(),t._v(" "),"回收物流-回收利用企业"==e.row.type?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.lookGarbagebag(e.row,6)}}},[t._v("回收利用企业交接")]):t._e(),t._v(" "),"回收利用企业-再利用企业"==e.row.type?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.lookGarbagebag(e.row,8)}}},[t._v("再利用企业交接")]):t._e()],1)]}}])})],1),t._v(" "),a("div",{staticClass:"pafinationBox"},[a("div",[a("el-button",{attrs:{type:"primary"},on:{click:t.clickAddOrUp}},[t._v("添加车次")]),t._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:t.delAll}},[t._v("批量删除")])],1),t._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":t.pageSize,total:t.totalNum},on:{"current-change":t.changePage}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.addOrUpTit,visible:t.centerDialogVisible,width:"600px",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[a("div",{staticClass:"dialogMain"},[a("el-form",{ref:"addForm",attrs:{model:t.addForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"车辆",required:""}},[a("el-select",{attrs:{placeholder:"请选择车辆"},model:{value:t.addForm.vehicleid,callback:function(e){t.$set(t.addForm,"vehicleid",e)},expression:"addForm.vehicleid"}},t._l(t.carList,function(t,e){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"全部"!==t.number,expression:"item.number !== '全部'"}],key:e,attrs:{label:t.number,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"运输人",required:""}},[a("el-select",{attrs:{placeholder:"请选择运输人"},model:{value:t.addForm.userid,callback:function(e){t.$set(t.addForm,"userid",e)},expression:"addForm.userid"}},t._l(t.userList,function(t,e){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"全部"!==t.username,expression:"item.username !== '全部'"}],key:e,attrs:{label:t.username,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"类型",required:""}},[a("el-select",{attrs:{placeholder:"请选择类型"},model:{value:t.addForm.type,callback:function(e){t.$set(t.addForm,"type",e)},expression:"addForm.type"}},t._l(t.typeList,function(t,e){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"全部"!==t.text,expression:"item.text !== '全部'"}],key:e,attrs:{label:t.text,value:t.value}})}),1)],1),t._v(" "),"编辑车次"==t.addOrUpTit?a("el-form-item",{attrs:{label:"状态",required:""}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:t.addForm.status,callback:function(e){t.$set(t.addForm,"status",e)},expression:"addForm.status"}},t._l(t.statusList,function(t,e){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"全部"!==t.text,expression:"item.text !== '全部'"}],key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:t.addForm.note,callback:function(e){t.$set(t.addForm,"note",e)},expression:"addForm.note"}})],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addSaveForm()}}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"医疗机构交接记录",visible:t.hospitalIf,width:"90%",center:""},on:{"update:visible":function(e){t.hospitalIf=e}}},[a("div",{staticClass:"dialogMain"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.hospitalJoinList}},[a("el-table-column",{attrs:{prop:"",label:"时间",width:"150",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.time?a("span"):a("span",[t._v(t._s(t._f("formatDate")(e.row.time)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"truck.vehicle.number",label:"运输车牌"}}),t._v(" "),a("el-table-column",{attrs:{prop:"hospital.name",label:"医疗机构"}}),t._v(" "),a("el-table-column",{attrs:{prop:"plasticnumber",label:"塑料数量(袋)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"plasticweight",label:"塑料重量(kg)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"glassnumber",label:"玻璃数量(袋)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"glassweight",label:"玻璃重量(kg)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"submitUser.username",label:"提交人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"confirmUser.username",label:"确认人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注"}})],1)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"回收利用企业交接记录",visible:t.chulichangIf,width:"90%",center:""},on:{"update:visible":function(e){t.chulichangIf=e}}},[a("div",{staticClass:"dialogMain"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.chulichangList}},[a("el-table-column",{attrs:{prop:"",label:"时间",width:"135",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.time?a("span"):a("span",[t._v(t._s(t._f("formatDate")(e.row.time)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"truck.vehicle.number",label:"运输车牌"}}),t._v(" "),a("el-table-column",{attrs:{prop:"treatmentplant.name",label:"回收利用企业"}}),t._v(" "),a("el-table-column",{attrs:{prop:"plasticnumber",label:"塑料数量(袋)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"plasticweight",label:"塑料重量(kg)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"glassnumber",label:"玻璃数量(袋)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"glassweight",label:"玻璃重量(kg)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"submitUser.username",label:"提交人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"confirmUser.username",label:"确认人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注"}})],1)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"再利用企业交接记录",visible:t.shengchangIf,width:"90%",center:""},on:{"update:visible":function(e){t.shengchangIf=e}}},[a("div",{staticClass:"dialogMain"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.shengchangList}},[a("el-table-column",{attrs:{prop:"",label:"时间",width:"135",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.time?a("span"):a("span",[t._v(t._s(t._f("formatDate")(e.row.time)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"truck.vehicle.number",label:"运输车牌"}}),t._v(" "),a("el-table-column",{attrs:{prop:"productionplant.name",label:"再利用企业"}}),t._v(" "),a("el-table-column",{attrs:{prop:"plasticweight",label:"塑料重量(kg)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"glassweight",label:"玻璃重量(kg)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"submitUser.username",label:"提交人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"confirmUser.username",label:"确认人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注"}})],1)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"交接记录",visible:t.yunshuIf,width:"90%",center:""},on:{"update:visible":function(e){t.yunshuIf=e}}},[a("div",{staticClass:"dialogMain"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.yunshuList}},[a("el-table-column",{attrs:{prop:"",label:"时间",width:"135",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.time?a("span"):a("span",[t._v(t._s(t._f("formatDate")(e.row.time)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"truck.vehicle.number",label:"运输车牌"}}),t._v(" "),a("el-table-column",{attrs:{prop:"plasticnumber",label:"塑料数量(袋)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"plasticweight",label:"塑料重量(kg)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"glassnumber",label:"玻璃数量(袋)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"glassweight",label:"玻璃重量(kg)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"submitUser.username",label:"提交人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"confirmUser.username",label:"确认人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注"}})],1)],1)])],1)},staticRenderFns:[]};var r=a("VU/8")(l,s,!1,function(t){a("I1l2")},"data-v-363c3bb3",null);e.default=r.exports}});
//# sourceMappingURL=38.02739f1acaa60048700b.js.map