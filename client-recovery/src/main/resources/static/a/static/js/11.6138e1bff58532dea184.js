webpackJsonp([11],{DLPa:function(e,t){},o106:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={props:["lng","lat","addressName"],data:()=>({address:"",longitude:"",latitude:"",ifIsTrue:!1}),watch:{addressName(){this.mapLoad(this.lng,this.lat)}},mounted:function(){this.mapLoad(this.lng,this.lat)},methods:{mapLoad(e,t){console.log(e,t),e&&t||0!=e&&0!=t||(e=116.395636,t=39.929983);var a=this,l=new BMap.Map("allmap"),i=new BMap.Geolocation;if(this.addressName){var o=new BMap.Point(e,t);l.addOverlay(new BMap.Marker(o)),l.centerAndZoom(o,10),console.log(o),l.panTo(o),a.address=this.addressName,a.longitude=e,a.latitude=t,a.ifIsTrue=!0}else a.ifIsTrue=!1,i.getCurrentPosition(function(e){if(this.getStatus()==BMAP_STATUS_SUCCESS){a.address=e.address.city,a.longitude=e.point.lng,a.latitude=e.point.lat;var t=new BMap.Point(e.point.lng,e.point.lat);l.addOverlay(new BMap.Marker(t)),l.centerAndZoom(t,10),l.panTo(e.point)}else alert("failed"+this.getStatus())},{enableHighAccuracy:!0});l.enableScrollWheelZoom(!0);var s=new BMap.Geocoder;l.addEventListener("click",function(e){a.ifIsTrue=!0;var t=e.point;s.getLocation(t,function(e){l.clearOverlays();var t=new BMap.Point(e.point.lng,e.point.lat);l.addOverlay(new BMap.Marker(t)),l.panTo(e.point),a.longitude=e.point.lng,a.latitude=e.point.lat,a.address=e.address,console.log(e);var i=e.point;a.$emit("lngLatData",i)})})},chooesAddress(){this.longitude="",this.latitude="",this.address="",this.ifIsTrue=!1,this.mapLoad(this.lng,this.lat),this.$emit("ifIsClose",!1)}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"hello"},[a("div",{attrs:{id:"allmap"}}),e._v(" "),a("div",{staticClass:"addressbox"},[e._v("\n      "+e._s(e.address)+"（"+e._s(e.longitude)+","+e._s(e.latitude)+"）\n      \n      "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.ifIsTrue,expression:"ifIsTrue"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.chooesAddress()}}},[e._v("确 定")])],1),e._v(" "),a("div")])},staticRenderFns:[]};var o={components:{lngLatMap:a("VU/8")(l,i,!1,function(e){a("DLPa")},"data-v-62931ae0",null).exports},data:()=>({page:1,pageSize:10,totalNum:100,form:{item:null,leadername:null},addOrUpTit:"",addForm:{id:null,name:null,leadername:null,leaderphone:null,hospitalid:null,note:null},tableData:[],multipleSelection:[],centerDialogVisible:!1,innerVisible:!1,endPickerOptions:{disabledDate:e=>e.getTime()<Date.now()-864e5}}),mounted(){this.addForm.hospitalid=this.$route.query.hospitalId,this.getData()},watch:{addForm:function(e,t){console.log(e)}},methods:{exportMobanFile(e){window.location.href="http://hrt.chinagrp.org.cn/recovery/fileDownload/departmentExcel"},exportBarCode(e){var t=void 0==this.$route.query.hospitalId?sessionStorage.getItem("belongId"):this.$route.query.hospitalId;console.log(t),window.location.href="http://hrt.chinagrp.org.cn/recovery/department/barcodeExcel?hospitalid="+t},doCopy:function(e){console.log();var t=(void 0==this.$route.query.hospitalId?sessionStorage.getItem("belongId"):this.$route.query.hospitalId)+"-"+new Date/1e3*1e3+"-"+e.id;console.log(t),this.$copyText(t).then(function(e){console.log(e)},function(e){console.log(e)})},getHospitalList(){var e=this,t={id:"",name:"全部"};this.$ajax.get("/recovery/hospital/selectAll").then(function(a){console.log("医疗机构列表",a),e.hospitalList=a.data.list,e.hospitalList.unshift(t)})},add(){this.$refs.upFile.click()},fileChanged(){const e=this.$refs.upFile.files;if(console.log(e),0!=e.length)for(var t=this,a=void 0==this.$route.query.hospitalId?sessionStorage.getItem("belongId"):this.$route.query.hospitalId,l=0;l<e.length;l++){var i=new FormData,o=e[l];i.append("excelFile",o),i.append("hospitalid",a),this.$ajax.post("/recovery/addDepartmentExcel/add",i,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){console.log(260==e.data.status),t.getData(),t.$refs.upFile.value="",260==e.data.status?t.$message.success("导入科室成功"):t.$message.error("导入科室失败,请重试！")})}else alert("请选择文件")},getData(){var e=this;console.log(this.$route.query.hospitalId),this.$ajax.get("/recovery/department/selectVByPage",{params:{page:this.page,rows:this.pageSize,name:this.form.item,hospitalid:void 0==this.$route.query.hospitalId?sessionStorage.getItem("belongId"):this.$route.query.hospitalId,leadername:this.form.leadername}}).then(function(t){console.log(t),260==t.data.status?(e.tableData=t.data.list,e.totalNum=t.data.info.total):(e.tableData=[],e.totalNum=0)})},changePage(e){this.page=e,this.getData()},selectList(){this.page=1,this.getData()},clearSelect(){this.form={item:null,leadername:null},this.getData()},clearForm(){this.addForm={id:null,name:null,leadername:null,leaderphone:null,hospitalid:void 0==this.$route.query.hospitalId?sessionStorage.getItem("belongId"):this.$route.query.hospitalId,note:null}},clickAddOrUp(){this.centerDialogVisible=!0,this.addOrUpTit="创建科室",this.clearForm()},handleEdit(e,t){console.log(e,t);this.centerDialogVisible=!0,this.addOrUpTit="编辑科室",this.addForm={id:t.id,name:t.name,leadername:t.leadername,leaderphone:t.leaderphone,hospitalid:t.hospitalid,note:t.note}},addSaveForm(){if(console.log(this.addForm),null!=this.addForm.name&&null!=this.addForm.hospitalid&&null!=this.addForm.leadername&&null!=this.addForm.leaderphone){var e=this,t=this.$qs.stringify(this.addForm,{indices:!1});"创建科室"==this.addOrUpTit?this.$ajax.post("/recovery/department/insert ",t).then(function(t){260==t.data.status&&(e.centerDialogVisible=!1,e.$message.success("添加成功"),e.getData(),e.clearForm())}):this.$ajax.put("/recovery/department/update",t).then(function(t){260==t.data.status&&(e.centerDialogVisible=!1,e.$message.success("编辑成功"),e.getData(),e.clearForm())})}else this.$message.error("*为必填项！")},delAll(){if(this.multipleSelection.length<1)return this.$message.success("请先选择删除对象");this.$confirm("此操作将永久删除选中的科室, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.multipleSelection.length==this.tableData.length&&(this.page=Number(this.page)-1);var e=this;this.$ajax.delete("/recovery/department/deletes",{data:this.multipleSelection}).then(function(t){260==t.data.status&&(e.$message.success("删除成功"),e.getData())})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},handleSelectionChange(e){this.multipleSelection=[];for(var t=0;t<e.length;t++)this.multipleSelection.push(e[t].id);console.log(this.multipleSelection)},handleDelete(e,t){this.$confirm("此操作将删除该科室, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log(e,t),1==this.tableData.length&&(this.page=Number(this.page)-1);var a=this;this.$ajax.delete("/recovery/department/delete",{params:{id:t}}).then(function(e){260==e.data.status&&(a.$message.success("删除成功"),a.getData())})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"yudingBox"}},[a("div",{staticClass:"selectBox"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"科室名称"}},[a("el-input",{on:{change:e.selectList},model:{value:e.form.item,callback:function(t){e.$set(e.form,"item",t)},expression:"form.item"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"负责人"}},[a("el-input",{on:{change:e.selectList},model:{value:e.form.leadername,callback:function(t){e.$set(e.form,"leadername",t)},expression:"form.leadername"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"30px"}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"warning",size:"small"},on:{click:e.clearSelect}},[e._v("清空筛选")]),e._v(" "),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"primary",size:"small"},on:{click:e.add}},[e._v("批量导入")]),e._v(" "),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"success",size:"small"},on:{click:e.exportBarCode}},[e._v("导出科室二维码")]),e._v(" "),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"success",size:"small"},on:{click:e.exportMobanFile}},[e._v("下载模版")]),e._v(" "),a("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"upFile",attrs:{type:"file"},on:{change:e.fileChanged}})],1)],1)],1),e._v(" "),a("div",{staticClass:"tableBox"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"hospital.name",label:"所属医疗机构"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"科室名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"leadername",label:"负责人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"leaderphone",label:"负责人电话"}}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.doCopy(t.row)}}},[e._v("复制科室码")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"pafinationBox"},[a("div",[a("el-button",{attrs:{type:"primary"},on:{click:e.clickAddOrUp}},[e._v("添加科室")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:e.delAll}},[e._v("批量删除")])],1),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":e.pageSize,total:e.totalNum},on:{"current-change":e.changePage}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.addOrUpTit,visible:e.centerDialogVisible,width:"600px",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("div",{staticClass:"dialogMain"},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"科室名称",required:""}},[a("el-input",{model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"负责人",required:""}},[a("el-input",{model:{value:e.addForm.leadername,callback:function(t){e.$set(e.addForm,"leadername",t)},expression:"addForm.leadername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"负责人电话",required:""}},[a("el-input",{model:{value:e.addForm.leaderphone,callback:function(t){e.$set(e.addForm,"leaderphone",t)},expression:"addForm.leaderphone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.addForm.note,callback:function(t){e.$set(e.addForm,"note",t)},expression:"addForm.note"}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addSaveForm()}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var n=a("VU/8")(o,s,!1,function(e){a("tNat")},"data-v-784725fb",null);t.default=n.exports},tNat:function(e,t){}});
//# sourceMappingURL=11.6138e1bff58532dea184.js.map